let fps=0,_fpsCounter=0;class Scene{constructor(t){this.canvasID=t,this.canvas=document.getElementById(t),this.ctx=this.canvas.getContext("2d"),this.objects=new Set}_tick(){let t=this.objects;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let e of t)e._tick(this),e.render(this.ctx);this.tick(),_fpsCounter++,this.reqHandle=requestAnimationFrame(()=>this._tick())}create(t){this.objects.add(t),void 0!==t.oncreate&&t.oncreate(this),t.behaviors.forEach(e=>{void 0!==e.create&&e.create(t)})}destroy(t){this.objects.delete(t),void 0!==t.ondestroy&&t.ondestroy(this),t.behaviors.forEach(e=>{void 0!==e.destroy&&e.destroy(t)})}start(){void 0!==this.onstart&&this.onstart(),this.reqHandle=requestAnimationFrame(()=>this._tick.call(this))}stop(){void 0!==this.onstop&&this.onstop(),cancelAnimationFrame(this.reqHandle)}tick(){}}class SceneObject{constructor({x:t=0,y:e=0,rotation:s=0,color:i="black"}){this.x=t,this.y=e,this.rotation=s,this.color=i,this.behaviors=[],this.velocity={x:0,y:0}}_tick(t){this.behaviors.forEach(e=>{e.tick(this,t)}),this.x+=this.velocity.x,this.y+=this.velocity.y,this.tick()}render(){}tick(){}}class Behavior{}class Model{constructor(t=null){t&&this.load(t)}load(t){return Array.isArray(t[0])?this.model=t.map(t=>({x:t[0],y:t[1]})):"object"==typeof t[0]&&(this.model=t),this}get(){return this.model}detail(t){let e=this.model,s=[];return e.forEach((t,e,i)=>{let o=i[e+1]||i[0];s.push({x:t.x,y:t.y}),s.push({x:(t.x+o.x)/2,y:(t.y+o.y)/2})}),this.model=s,t>0&&this.detail(t-1),this}roughness(t){for(let e=0;e<this.model.length;e++){let s=this.model[e];this.model[e]={x:s.x+randomInt(2*t)-t,y:s.y+randomInt(2*t)-t}}return this}}function pointInPoly(t,e,s){let i,o,r=0;for(i=0,o=t.length-1;i<t.length;o=i++)t[i][1]>s!=t[o][1]>s&&e<(t[o][0]-t[i][0])*(s-t[i][1])/(t[o][1]-t[i][1])+t[i][0]&&(r=!r);return r}function random(t,e){return Math.random()*(e-t)+t}function randomInt(t,e){return Math.floor(Math.random()*(e-t)+t)}function deg2rad(t){return t*Math.PI/180}function rad2deg(t){return 180*t/Math.PI}setInterval(()=>{fps=_fpsCounter,_fpsCounter=0},1e3);let Physics;(()=>{let t=Matter.Engine,e=Matter.Runner,s=Matter.Bodies,a=Matter.Composite,i=t.create();let o=e.create();e.run(o,i),Physics=class extends Behavior{constructor(t={}){super(),this.params=t}create(t){t instanceof StaticMesh&&(this.params.isStatic=!0),this.body=s.fromVertices(t.x,t.y,t.model,this.params),a.add(i.world,[this.body])}tick(t){t.y=this.body.position.y,t.x=this.body.position.x,t.angle=rad2deg(this.body.angle),t.angleRad=this.body.angle}}})();class Actor extends SceneObject{constructor({x:t=0,y:s=0,model:o=[],rotation:e=0,color:i="black"}){super({x:t,y:s,model:o,rotation:e,color:i}),this.x=t,this.y=s,this.model=o,this.angle=e,this.color=i,this.behaviors=[],this.velocity={x:0,y:0}}render(t){let s=this.model;t.fillStyle=this.color,t.strokeStyle=this.color,t.translate(this.x,this.y),t.rotate(this.angleRad),t.translate(-this.x,-this.y),t.beginPath(),t.moveTo(this.x+s[0].x,this.y+s[0].y);for(let o=1;o<s.length;o++)t.lineTo(this.x+s[o].x,this.y+s[o].y);t.lineTo(this.x+s[0].x,this.y+s[0].y),t.fill(),t.setTransform(1,0,0,1,0,0)}}